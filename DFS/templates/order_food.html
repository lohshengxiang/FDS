{% extends "base_profile.html" %}

{% block content %}

    <!-- <div class="container"> -->
        <section class="hero is-success welcome is-small is-bold">
            <div class="hero-body">
                <div class="container has-text-left">
                    <h1 class="title" style = "font-size: 200%;">
                        Welcome to {{ rname }}
                    </h1>
                </div>
            </div>
        </section>
        <br>
        <br>
        <br>
        <div class="columns">
            <div class="column is-3 ">
                <aside class="menu is-hidden-mobile">
                    <ul class="menu-list">
                        <li><a class="is-active" href = "/order/{{rname}}">1. Order Food</a></li>
                        <br>
                        <li><a class="is-static">2. Address</a><li>
                        <br>
                        <li><a class="is-static">3. Payment</a><li>
                        <br>
                        <li><a class="is-static">4. Order Confirmation</a><li>
                    </ul>
                </aside>
            </div>
            <div id = 'profile' class="column is-9">
                <section class="hero is-small">
                    <h1>
                    {% if cart_list == [] %}
                    You have no orders
                    {% endif %}
                    {% if not cart_list == [] %}
                    <table class="table" style="margin-left:auto;margin-right:auto;">
                        <thead class="thead">
                            <tr>
                                <th>Food Item</th>
                                <th>Quantity</th>
                                <th>Cost</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for item in cart_list %}
                        <tr>
                            <td>{{item.fname}}</td>
                            <td>{{item.quantity}}</td>
                            <td>{{item.food_cost}}</td>
                        </tr>
                        {% endfor %}
                        <tr>
                            <td></td>
                            <td>Delivery Cost:</br>Total Cost:</td>
                            <td>{{delivery_fee}}</br>{{total_cost + delivery_fee}}</td>
                        </tr>
                        </tbody>
                    </table>
                    <!-- Your current order is {{ cart_list }} -->
                    {% endif %}
                    </h1>
                </section>
                <section class="section">
                    <form action = "" method="POST">
                      <div class="column">
                        {{ form.csrf_token }}
                        <div>
                          <font size="6"><b>Food:</b></font>
                          <div class = "select"> 
                          {{ form.fname }}
                          </div>
                        </div>
                        <div>
                          <font size="6"><b>Quantity:</b></font>
                          <div class = "select"> 
                            {{ form.quantity }}
                          </div>
                        </div>
                        <script>
                          var rname = '{{ runame }}';
                          let fname_select = document.getElementById('fname');
                          let quantity_select = document.getElementById('quantity');


                          fname_select.onchange = function() {
                            fname = fname_select.value; //get rname value

                            fetch('/quantity/' + fname +'/'+ rname ).then(function(response) { //get response object
                              response.json().then(function(data) {

                                let optionHTML = '';

                                for (let quantity of data.quantity){ //data.rname is an array of rname from /fname/rname

                                  optionHTML += '<option value = "' + quantity.id + '">' + quantity.quantity + '</option>'; //create options for html

                                }
                                quantity_select.innerHTML = optionHTML; //replace inner html in forms
                              });

                            }); 

                          }

                        </script>
                        <div>
                          <div class= "buttons has-addons is-centered">
                            <button class="button is-block is-info is-medium button-padding-horizontal:2em" type = "submit">Add</button>
                          </div>
                        </div>
                      </div>
                    </form>
                    <br>
                    <div class= "buttons has-addons is-centered">
                      <a href = "/order/{{rname}}/address">
                            <button class="button is-block is-light is-medium button-padding-horizontal:2em">Next</button>
                        </a>
                    </div>
                </section>                
            </div>
        </div>
    <!-- </div> -->

    <!-- <script async type="text/javascript" src="../js/bulma.js"></script> -->
{% endblock %}